http:
  # ============================================
  # Routers for services behind Gluetun VPN
  # ============================================
  routers:
    # qBittorrent - Torrent Client
    qbittorrent:
      rule: "Host(`qbittorrent.local`) || Host(`qb.local`) || Host(`torrent.local`)"
      entryPoints:
        - websecure
      service: qbittorrent-service
      middlewares:
        - homelab-admin@file # Requires authentication
      tls:
        certResolver: letsencrypt

    # Prowlarr - Indexer Manager
    prowlarr:
      rule: "Host(`prowlarr.local`)"
      entryPoints:
        - websecure
      service: prowlarr-service
      middlewares:
        - media-services@file
      tls:
        certResolver: letsencrypt

    # NZBGet - Usenet Client
    nzbget:
      rule: "Host(`nzbget.local`) || Host(`usenet.local`)"
      entryPoints:
        - websecure
      service: nzbget-service
      middlewares:
        - homelab-admin@file
      tls:
        certResolver: letsencrypt

  # ============================================
  # Services for Gluetun-backed applications
  # ============================================
  services:
    # qBittorrent Service
    qbittorrent-service:
      loadBalancer:
        servers:
          # Use Gluetun's IP on the media network
          - url: "http://172.21.0.2:8080"
        passHostHeader: true
        healthCheck:
          path: /
          interval: 30s
          timeout: 5s

    # Prowlarr Service
    prowlarr-service:
      loadBalancer:
        servers:
          - url: "http://172.21.0.2:9696"
        passHostHeader: true
        healthCheck:
          path: /ping
          interval: 30s
          timeout: 5s

    # NZBGet Service
    nzbget-service:
      loadBalancer:
        servers:
          - url: "http://172.21.0.2:6789"
        passHostHeader: true
        healthCheck:
          path: /
          interval: 30s
          timeout: 5s

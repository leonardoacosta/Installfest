# Homelab Docker Compose - Main Orchestrator
# Uses the include feature (requires Docker Compose 2.20.3+)
# This file defines shared networks and includes modular service definitions

# Shared networks used by all services
networks:
  # Primary homelab network for most services
  homelab:
    name: homelab
    driver: bridge
    enable_ipv6: false
    ipam:
      config:
        - subnet: 172.20.0.0/24
          gateway: 172.20.0.1
          ip_range: 172.20.0.128/25
    driver_opts:
      com.docker.network.bridge.name: br-homelab

  # Dedicated network for media services
  media:
    name: media
    driver: bridge
    enable_ipv6: false
    ipam:
      config:
        - subnet: 172.21.0.0/24
          gateway: 172.21.0.1
          ip_range: 172.21.0.128/25
    driver_opts:
      com.docker.network.bridge.name: br-media

# Include modular service definitions
# Comment out any includes to disable entire stacks
include:
  # Core infrastructure (Traefik, AdGuard, Home Assistant, Vaultwarden)
  - compose/infrastructure.yml

  # Monitoring and dashboards (Glance)
  - compose/monitoring.yml

  # VPN and security services (Tailscale, Gluetun)
  - compose/vpn.yml

  # Media server stack (*arr apps, Jellyfin, downloaders)
  - compose/media.yml

  # AI and LLM services (Ollama)
  - compose/ai.yml

  # Storage services (Samba)
  - compose/storage.yml

  # Platform as a Service (Coolify)
  - compose/platform.yml

  # Optional: Override configurations for local environment
  # - compose.override.yml

# Note: You can still define services here if needed for quick testing
# services:
#   test-service:
#     image: nginx:alpine
#     ports:
#       - "8888:80"